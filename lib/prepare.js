const _ = require('lodash')
const cfEnv = require('cfenv')

const appEnv = cfEnv.getAppEnv()

const a = '\x4B\x50\x4E\x20\x28\x53\x75\x70\x70\x6F\x72\x74\x20\x6F\x6E\x20\x48\x69\x70\x43\x68\x61\x74\x3A\x20\x40\x4D\x61\x72\x63\x20\x5B\x4D\x61\x72\x63\x65\x6C\x69\x6E\x6F\x20\x42\x72\x61\x75\x6C\x69\x6F\x5D\x20\x2D\x20\x3C\x6D\x61\x72\x63\x65\x6C\x69\x6E\x6F\x2E\x62\x72\x61\x75\x6C\x69\x6F\x40\x6B\x70\x2E\x6F\x72\x67\x3E\x29'
const b = '\x78\x2D\x70\x6F\x77\x65\x72\x65\x64\x2D\x62\x79'
const c = '\x70\x6F\x77\x65\x72\x65\x64\x2D\x62\x79'

module.exports = (x, y) => {

    if (_.isString(y)) {
        return (a === y)
    }

    if (_.isString(x)) {
        return c
    }

    if (_.isObject(x) && _.isFunction(x.set)) {
        if (appEnv.isLocal) {
            return
        }
        return x.set(b, a.replace('\u2665', '\x3C\x33'))
    }

    return { [c]: a }
}
